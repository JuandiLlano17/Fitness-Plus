<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editar ejercicios</title>
    <!-- Archivos CSS -->
    <link rel="stylesheet" href="estilos_generales.css">
    <link rel="stylesheet" href="estilos_edi_entrenador.css">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script src= "js/Carga_header_footer.js"></script>
</head>
<body>
    <header></header>

    <div class="editar-ejercicios">
        <a href="Cliente-Entrenado.html">
            <img class="logos-icon" alt="Logos" src="img/Logos_flecha.svg">
          </a>
            <div class="meet-section">
                <h1>Editar Ejercicios</h1>
                <h2>Escoge el día, el tipo de músculo y agrega los ejercicios con las repeticiones correspondientes para cada cliente</h2>

                <div class="dias-container">
                    <h2 class="dia">Lunes</h2>
                    <h2 class="dia">Martes</h2>
                    <h2 class="dia">Miércoles</h2>
                    <h2 class="dia">Jueves</h2>
                    <h2 class="dia">Viernes</h2>
                </div>
            </div>
            <div class="opciones">
                <!-- Opciones para el Tiempo de la Rutina -->
                <div class="radio-options">
                    <details class="custom-dropdown">
                        <summary class="dropdown-header d-header"id="tiempoSeleccionado">Tiempo de la Rutina</summary>
                        <input type="radio" id="30min" name="tiempo-rutina" value="30min" />
                        <label for="30min" class="custom-radio">30 minutos</label><br>

                        <input type="radio" id="45min" name="tiempo-rutina" value="45min" />
                        <label for="45min" class="custom-radio">45 minutos</label><br>

                        <input type="radio" id="60min" name="tiempo-rutina" value="60min" />
                        <label for="60min" class="custom-radio">60 minutos</label><br>

                        <input type="radio" id="90min" name="tiempo-rutina" value="90min" />
                        <label for="90min" class="custom-radio">90 minutos</label>
                    </details>
                </div>

                <!-- Opciones para el Músculo -->
                <div class="radio-options">
                    <details class="custom-dropdown">
                        <summary class="dropdown-header d-header"id="musculoSeleccionado">Músculo</summary>
                        <input type="radio" id="pecho" name="musculo" value="pecho" />
                        <label for="pecho" class="custom-radio">Pecho</label><br>

                        <input type="radio" id="espalda" name="musculo" value="espalda" />
                        <label for="espalda" class="custom-radio">Espalda</label><br>

                        <input type="radio" id="Piernas" name="musculo" value="piernas" />
                        <label for="Piernas" class="custom-radio">Piernas</label><br>

                        <input type="radio" id="hombros" name="musculo" value="hombros" />
                        <label for="hombros" class="custom-radio">Hombros</label><br>

                        <input type="radio" id="Brazos" name="musculo" value="brazos" />
                        <label for="Brazos" class="custom-radio">Brazos</label><br>

                        <input type="radio" id="abdomen" name="musculo" value="abdomen" />
                        <label for="abdomen" class="custom-radio">Abdomen</label>
                    </details>
                </div>
                
                
                <div class="exercise-container">
                    <!-- Opciones para agregar ejercicio -->
                    <div class="radio-options" style="order: 2;">
                        <details class="custom-dropdown">
                            <summary class="d-mas">+</summary>
                             <style>

                             </style>

                            <!-- Aquí se llenará dinámicamente con los ejercicios desde JavaScript -->
                            <div class="exercise-list" style="display:none;"></div>  <!-- Contenedor oculto -->
                        </details>
                    </div>
                </div>
                
                

            </div>
            <button class="button button-centrado">
                Guardar
            </button>
    </div>

     <!-- Modal Borrar Ejercicio -->
     <div id="borrarModal" class="modal">
        <div class="modal-content">
            ¿Desea Borrar?
            <div class="boton-parent">
                <button class="button">Si</button>
                <button class="button">No</button>
            </div>
        </div>
    </div>

    <!-- Modal Ejercicio Borrado -->
    <div id="ejercicioBorradoModal" class="modal">
        <div class="modal-content">
            Se ha borrado el ejercicio
        <button class="button">Cerrar</button>
    </div>
</div>

<!-- Modal Guardado -->
<div id="guardarModal" class="modal">
    <div class="modal-content">
        Se ha guardado la rutina
        <a href="Cliente-Entrenado.html">
        <button class="button">Cerrar</button>
        </a>
    </div>
</div>
    <footer></footer>
    <!-- JavaScript -->
    <script>
document.addEventListener('DOMContentLoaded', function () {
    // Para el tiempo 
    const radiosTiempo = document.querySelectorAll('input[name="tiempo-rutina"]');
    const summaryTiempo = document.getElementById('tiempoSeleccionado');
    // Para el músculo
    const radiosMusculo = document.querySelectorAll('input[name="musculo"]');
    const summaryMusculo = document.getElementById('musculoSeleccionado');
    // Obtener el modal y el campo para el nombre del ejercicio
    const modal = document.getElementById('crearEjercicioModal');
    const ejercicioNombre = document.getElementById('ejercicio-nombre');
    const radioButtons = document.querySelectorAll('input[name="agregar"]');
    // Obtener los modales de borrado y sus botones
    const borrarModal = document.getElementById('borrarModal');
    const siButton = borrarModal.querySelector('.boton-parent .button:first-child');
    const noButton = borrarModal.querySelector('.boton-parent .button:last-child');
    const borrarButtons = document.querySelectorAll('.frame .button');
    // Guardar modal y botón de guardar
    const guardarModal = document.getElementById('guardarModal');
    const guardarButton = document.querySelector('.button-centrado');
    // Mostrar el modal de confirmación de borrado al hacer clic en borrar
    borrarButtons.forEach(boton => {
        boton.addEventListener('click', function () {
            borrarModal.style.display = 'block'; // Mostrar el modal
        });
    });
    // Al hacer clic en "Sí", ocultar el modal
    siButton.addEventListener('click', function () {
        borrarModal.style.display = 'none'; // Ocultar el modal de confirmación
        modal.style.display = 'none'; // Ocultar también el modal de creación de ejercicios (si es necesario)
    });
    // Al hacer clic en "No", simplemente ocultar el modal de confirmación
    noButton.addEventListener('click', function () {
        borrarModal.style.display = 'none'; // Ocultar el modal de confirmación
    });
    // Función para actualizar el texto del summary de tiempo de la rutina
    function actualizarTiempo() {
        const tiempoSeleccionado = Array.from(radiosTiempo)
            .filter(radio => radio.checked) // Filtrar el que está seleccionado
            .map(radio => radio.labels[0].innerText); // Obtener el texto de la etiqueta
        // Si hay una medida seleccionada, mostrarla
        if (tiempoSeleccionado.length > 0) {
            summaryTiempo.textContent = tiempoSeleccionado[0]; // Mostrar la medida seleccionada
            summaryTiempo.style.color = 'black'; // Cambiar el color a negro
        } else {
            summaryTiempo.textContent = 'Tiempo de la Rutina'; // Texto predeterminado
            summaryTiempo.style.color = ''; // Volver al color predeterminado
        }
    }
    // Función para actualizar el texto del summary de músculo
    function actualizarMusculo() {
        const musculoSeleccionado = Array.from(radiosMusculo)
            .filter(radio => radio.checked) // Filtrar el que está seleccionado
            .map(radio => radio.labels[0].innerText); // Obtener el texto de la etiqueta
        // Si hay un músculo seleccionado, mostrarlo
        if (musculoSeleccionado.length > 0) {
            summaryMusculo.textContent = musculoSeleccionado[0]; // Mostrar el músculo seleccionado
            summaryMusculo.style.color = 'black'; // Cambiar el color a negro
        } else {
            summaryMusculo.textContent = 'Músculo'; // Texto predeterminado
            summaryMusculo.style.color = ''; // Volver al color predeterminado
        }
    }
    // Actualizar el contenido del modal de ejercicios cuando se selecciona un ejercicio
    radioButtons.forEach(radio => {
        radio.addEventListener('click', function () {
            // Obtener el texto del label asociado al radio button seleccionado
            const label = document.querySelector(`label[for="${radio.id}"]`).innerText;
            // Cambiar el nombre del ejercicio en el modal
            ejercicioNombre.textContent = label;
            // Mostrar el modal
            modal.style.display = 'flex';  // Mostrar el modal
            modal.style.zIndex = '1000'; // Asegurar que esté por encima de otros elementos
        });
    });
    // Añadir eventos a los radio buttons de tiempo para detectar los cambios
    radiosTiempo.forEach(radio => {
        radio.addEventListener('change', actualizarTiempo);
    });
    // Añadir eventos a los radio buttons de músculo para detectar los cambios
    radiosMusculo.forEach(radio => {
        radio.addEventListener('change', actualizarMusculo);
    });
    // Actualizar los valores iniciales por si hay selección previa
    actualizarTiempo();
    actualizarMusculo();
    // Mostrar el modal de guardar cuando se hace clic en el botón "Guardar"
    guardarButton.addEventListener('click', function () {
        guardarModal.style.display = 'block'; // Mostrar el modal de guardado
    });
    // Cerrar el modal de guardar al hacer clic en el botón dentro del modal
    const cerrarGuardarButton = guardarModal.querySelector('button');
    cerrarGuardarButton.addEventListener('click', function () {
        guardarModal.style.display = 'none'; // Cerrar el modal
    });
});
    </script>


<script>
    // Función para actualizar los ejercicios basados en el músculo seleccionado
function actualizarEjercicios() {
    // Obtener el valor del músculo seleccionado
    let musculo = document.querySelector('input[name="musculo"]:checked').value;

    fetch('api/POST/editar_entrenador.php', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: 'musculo=' + musculo
    })
    .then(response => response.json())
    .then(data => {
        if (data.status === "success") {
            let ejercicios = data.data;

            let container = document.querySelector('.exercise-container .radio-options .exercise-list');
            container.innerHTML = '';  // Limpiar los ejercicios previos

            // Iterar sobre cada ejercicio y agregar el evento `click` solo una vez
            ejercicios.forEach(ejercicio => {
                let radioInput = document.createElement('input');
                radioInput.type = 'radio';
                radioInput.name = 'agregar';
                radioInput.value = ejercicio;
                radioInput.id = ejercicio.toLowerCase().replace(/ /g, '-');

                let label = document.createElement('label');
                label.htmlFor = radioInput.id;
                label.classList.add('custom-radio');
                label.textContent = ejercicio;

                // Agregar el input y el label al contenedor
                container.appendChild(radioInput);
                container.appendChild(label);
                container.appendChild(document.createElement('br'));

                // Agregar el evento `click` para cada ejercicio de forma controlada
                label.addEventListener('click', function() {
                    agregarEjercicioAlContenedor(ejercicio);
                });
            });
            
            // Hacer visible el contenedor de ejercicios cuando se haga clic en el "+" (summary)
            let details = container.closest('details');
            details.addEventListener('toggle', function() {
                container.style.display = details.open ? 'block' : 'none';
            });
        }
    })
    .catch(error => console.error('Error en la solicitud:', error));
}

// Función para agregar el div rojo con la imagen de fondo al lado izquierdo del botón "+"
function agregarEjercicioAlContenedor(ejercicio) {
    // Crear el div que representará el ejercicio seleccionado
    const ejercicioDiv = document.createElement('div');
    ejercicioDiv.classList.add('previsualizacion');  // Se agregará la clase para estilos generales desde el CSS

    // Crear un contenedor para la imagen de fondo
    const imagenDiv = document.createElement('div');
    imagenDiv.classList.add('imagen-fondo');  // Usaremos esta clase para los estilos de la imagen

    // Establecer el fondo del ejercicio con la imagen correspondiente
    const imagenFondo = `img/ejercicios/${ejercicio.replace(/ /g, '%20')}.png`;
    imagenDiv.style.backgroundImage = `url(${imagenFondo})`;
    imagenDiv.style.width = '100%';  // Ocupa el 100% del ancho del contenedor principal
    imagenDiv.style.height = '100%'; // Ocupa el 100% del alto del contenedor principal
    imagenDiv.style.backgroundSize = 'cover';
    imagenDiv.style.backgroundPosition = 'center';
    imagenDiv.style.filter = 'blur(3px)'; // Aplica el desenfoque
    imagenDiv.style.position = 'absolute'; // Para que la imagen esté por debajo de otros elementos

    // Añadir el contenedor de la imagen de fondo dentro del div principal
    ejercicioDiv.appendChild(imagenDiv);

    // Crear el título (h3) con el nombre del ejercicio
    const h3 = document.createElement('h3');
    h3.textContent = ejercicio;  // Asigna el nombre del ejercicio
    // Los estilos del h3 ya están en el archivo CSS bajo .previsualizacion h3

    // Agregar el h3 dentro del div de previsualización
    ejercicioDiv.appendChild(h3);

    // Obtener el contenedor donde agregar el div
    const exerciseContainer = document.querySelector('.exercise-container');
    const radioOptions = exerciseContainer.querySelector('.radio-options');
    
    // Insertar el nuevo div de previsualización a la izquierda del contenedor de opciones de radio
    exerciseContainer.insertBefore(ejercicioDiv, radioOptions);
    console.log("Div insertado en el contenedor:", ejercicioDiv);
}

// Asignar el evento a los inputs de músculo para que actualice los ejercicios disponibles
document.querySelectorAll('input[name="musculo"]').forEach(input => {
    input.addEventListener('change', actualizarEjercicios);
});

</script>

    
</body>
</html>