<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editar ejercicios</title>
    <!-- Archivos CSS -->
    <link rel="stylesheet" href="estilos_generales.css">
    <link rel="stylesheet" href="estilos_editar_entrenador.css">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
     $(document).ready(function () {
        // Cargar el header desde header.html
        $('header').load('header.html');
        // Cargar el footer desde footer.html
        $('footer').load('footer.html');
      });
    </script>
</head>
<body>
    <header></header>

    <div class="editar-ejercicios">
        <a href="Cliente-Entrenado.html">
            <img class="logos-icon" alt="Logos" src="img/Logos_flecha.svg">
          </a>
            <div class="meet-section">
                <h1>Editar Ejercicios</h1>
                <h2>Escoge el día, el tipo de músculo y agrega los ejercicios con las repeticiones correspondientes para cada cliente</h2>

                <div class="dias-container">
                    <h2 class="dia">Lunes</h2>
                    <h2 class="dia">Martes</h2>
                    <h2 class="dia">Miércoles</h2>
                    <h2 class="dia">Jueves</h2>
                    <h2 class="dia">Viernes</h2>
                </div>
            </div>
            <div class="opciones">
                <!-- Opciones para el Tiempo de la Rutina -->
                <div class="radio-options">
                    <details class="custom-dropdown">
                        <summary class="dropdown-header d-header"id="tiempoSeleccionado">Tiempo de la Rutina</summary>
                        <input type="radio" id="30min" name="tiempo-rutina" value="30min" />
                        <label for="30min" class="custom-radio">30 minutos</label><br>

                        <input type="radio" id="45min" name="tiempo-rutina" value="45min" />
                        <label for="45min" class="custom-radio">45 minutos</label><br>

                        <input type="radio" id="60min" name="tiempo-rutina" value="60min" />
                        <label for="60min" class="custom-radio">60 minutos</label><br>

                        <input type="radio" id="90min" name="tiempo-rutina" value="90min" />
                        <label for="90min" class="custom-radio">90 minutos</label>
                    </details>
                </div>

                <!-- Opciones para el Músculo -->
                <div class="radio-options">
                    <details class="custom-dropdown">
                        <summary class="dropdown-header d-header"id="musculoSeleccionado">Músculo</summary>
                        <input type="radio" id="pecho" name="musculo" value="pecho" />
                        <label for="pecho" class="custom-radio">Pecho</label><br>

                        <input type="radio" id="espalda" name="musculo" value="espalda" />
                        <label for="espalda" class="custom-radio">Espalda</label><br>

                        <input type="radio" id="Piernas" name="musculo" value="piernas" />
                        <label for="Piernas" class="custom-radio">Piernas</label><br>

                        <input type="radio" id="hombros" name="musculo" value="hombros" />
                        <label for="hombros" class="custom-radio">Hombros</label><br>

                        <input type="radio" id="Brazos" name="musculo" value="brazos" />
                        <label for="Brazos" class="custom-radio">Brazos</label><br>

                        <input type="radio" id="abdomen" name="musculo" value="abdomen" />
                        <label for="abdomen" class="custom-radio">Abdomen</label>
                    </details>
                </div>
                
                <!-- Contenedor para las previsualizaciones de los ejercicios -->
                <div id="previsualizacion-ejercicio-container"></div>


                <div class="exercise-container">
                    <!-- Opciones para agregar ejercicio -->
                    <div class="radio-options">
                        <details class="custom-dropdown">
                            <summary class="d-mas">+</summary>
                            <!-- Aquí se llenará dinámicamente con los ejercicios desde JavaScript -->
                            <div class="exercise-list" style="display:none;"></div>  <!-- Contenedor oculto -->
                        </details>
                    </div>
                </div>
                
                

            </div>
            <button class="button button-centrado">
                Guardar
            </button>
    </div>

     <!-- Modal Borrar Ejercicio -->
     <div id="borrarModal" class="modal">
        <div class="modal-content">
            ¿Desea Borrar?
            <div class="boton-parent">
                <button class="button">Si</button>
                <button class="button">No</button>
            </div>
        </div>
    </div>

    <!-- Modal Ejercicio Borrado -->
    <div id="ejercicioBorradoModal" class="modal">
        <div class="modal-content">
            Se ha borrado el ejercicio
        <button class="button">Cerrar</button>
    </div>
</div>

<!-- Modal Guardado -->
<div id="guardarModal" class="modal">
    <div class="modal-content">
        Se ha guardado la rutina
        <a href="Cliente-Entrenado.html">
        <button class="button">Cerrar</button>
        </a>
    </div>
</div>
    <footer></footer>
    <!-- JavaScript -->
    <script>
document.addEventListener('DOMContentLoaded', function () {
    // Para el tiempo 
    const radiosTiempo = document.querySelectorAll('input[name="tiempo-rutina"]');
    const summaryTiempo = document.getElementById('tiempoSeleccionado');
    // Para el músculo
    const radiosMusculo = document.querySelectorAll('input[name="musculo"]');
    const summaryMusculo = document.getElementById('musculoSeleccionado');
    // Obtener el modal y el campo para el nombre del ejercicio
    const modal = document.getElementById('crearEjercicioModal');
    const ejercicioNombre = document.getElementById('ejercicio-nombre');
    const radioButtons = document.querySelectorAll('input[name="agregar"]');
    // Obtener los modales de borrado y sus botones
    const borrarModal = document.getElementById('borrarModal');
    const siButton = borrarModal.querySelector('.boton-parent .button:first-child');
    const noButton = borrarModal.querySelector('.boton-parent .button:last-child');
    const borrarButtons = document.querySelectorAll('.frame .button');
    // Guardar modal y botón de guardar
    const guardarModal = document.getElementById('guardarModal');
    const guardarButton = document.querySelector('.button-centrado');
    // Mostrar el modal de confirmación de borrado al hacer clic en borrar
    borrarButtons.forEach(boton => {
        boton.addEventListener('click', function () {
            borrarModal.style.display = 'block'; // Mostrar el modal
        });
    });
    // Al hacer clic en "Sí", ocultar el modal
    siButton.addEventListener('click', function () {
        borrarModal.style.display = 'none'; // Ocultar el modal de confirmación
        modal.style.display = 'none'; // Ocultar también el modal de creación de ejercicios (si es necesario)
    });
    // Al hacer clic en "No", simplemente ocultar el modal de confirmación
    noButton.addEventListener('click', function () {
        borrarModal.style.display = 'none'; // Ocultar el modal de confirmación
    });
    // Función para actualizar el texto del summary de tiempo de la rutina
    function actualizarTiempo() {
        const tiempoSeleccionado = Array.from(radiosTiempo)
            .filter(radio => radio.checked) // Filtrar el que está seleccionado
            .map(radio => radio.labels[0].innerText); // Obtener el texto de la etiqueta
        // Si hay una medida seleccionada, mostrarla
        if (tiempoSeleccionado.length > 0) {
            summaryTiempo.textContent = tiempoSeleccionado[0]; // Mostrar la medida seleccionada
            summaryTiempo.style.color = 'black'; // Cambiar el color a negro
        } else {
            summaryTiempo.textContent = 'Tiempo de la Rutina'; // Texto predeterminado
            summaryTiempo.style.color = ''; // Volver al color predeterminado
        }
    }
    // Función para actualizar el texto del summary de músculo
    function actualizarMusculo() {
        const musculoSeleccionado = Array.from(radiosMusculo)
            .filter(radio => radio.checked) // Filtrar el que está seleccionado
            .map(radio => radio.labels[0].innerText); // Obtener el texto de la etiqueta
        // Si hay un músculo seleccionado, mostrarlo
        if (musculoSeleccionado.length > 0) {
            summaryMusculo.textContent = musculoSeleccionado[0]; // Mostrar el músculo seleccionado
            summaryMusculo.style.color = 'black'; // Cambiar el color a negro
        } else {
            summaryMusculo.textContent = 'Músculo'; // Texto predeterminado
            summaryMusculo.style.color = ''; // Volver al color predeterminado
        }
    }
    // Actualizar el contenido del modal de ejercicios cuando se selecciona un ejercicio
    radioButtons.forEach(radio => {
        radio.addEventListener('click', function () {
            // Obtener el texto del label asociado al radio button seleccionado
            const label = document.querySelector(`label[for="${radio.id}"]`).innerText;
            // Cambiar el nombre del ejercicio en el modal
            ejercicioNombre.textContent = label;
            // Mostrar el modal
            modal.style.display = 'flex';  // Mostrar el modal
            modal.style.zIndex = '1000'; // Asegurar que esté por encima de otros elementos
        });
    });
    // Añadir eventos a los radio buttons de tiempo para detectar los cambios
    radiosTiempo.forEach(radio => {
        radio.addEventListener('change', actualizarTiempo);
    });
    // Añadir eventos a los radio buttons de músculo para detectar los cambios
    radiosMusculo.forEach(radio => {
        radio.addEventListener('change', actualizarMusculo);
    });
    // Actualizar los valores iniciales por si hay selección previa
    actualizarTiempo();
    actualizarMusculo();
    // Mostrar el modal de guardar cuando se hace clic en el botón "Guardar"
    guardarButton.addEventListener('click', function () {
        guardarModal.style.display = 'block'; // Mostrar el modal de guardado
    });
    // Cerrar el modal de guardar al hacer clic en el botón dentro del modal
    const cerrarGuardarButton = guardarModal.querySelector('button');
    cerrarGuardarButton.addEventListener('click', function () {
        guardarModal.style.display = 'none'; // Cerrar el modal
    });
});
    </script>


<script>
    // Función para actualizar los ejercicios basados en el músculo seleccionado
function actualizarEjercicios() {
    // Obtener el valor del músculo seleccionado
    let musculo = document.querySelector('input[name="musculo"]:checked').value;

    // Mostrar el valor del músculo seleccionado en la consola para depuración
    console.log("Músculo seleccionado:", musculo);

    fetch('api/POST/editar_entrenador.php', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: 'musculo=' + musculo
    })
    .then(response => {
        console.log("Respuesta cruda del servidor:", response);  // Verifica la respuesta cruda antes de convertirla
        return response.text();  // Cambiar a text() para depuración
    })
    .then(text => {
        console.log("Respuesta del servidor (raw):", text);  // Verifica la respuesta cruda recibida

        try {
            // Intentamos convertir la respuesta en JSON
            let data = JSON.parse(text);
            console.log("Respuesta procesada en JSON:", data); // Mostrar los datos procesados

            // Verificar si la respuesta tiene la propiedad "status" y si es éxito
            if (data.status === "success") {
                let ejercicios = data.data;

                // Verificamos que "ejercicios" es un array
                if (Array.isArray(ejercicios)) {
                    // Seleccionar el contenedor donde se agregarán los ejercicios
                    let container = document.querySelector('.exercise-container .radio-options .exercise-list');
                    container.innerHTML = '';  // Limpiar los ejercicios previos

                    // Iterar sobre cada ejercicio recibido del servidor
                    ejercicios.forEach(ejercicio => {
                        let radioInput = document.createElement('input');
                        radioInput.type = 'radio';
                        radioInput.name = 'agregar';
                        radioInput.value = ejercicio;
                        radioInput.id = ejercicio.toLowerCase().replace(/ /g, '-');

                        let label = document.createElement('label');
                        label.htmlFor = radioInput.id;
                        label.classList.add('custom-radio');
                        label.textContent = ejercicio;

                        // Agregar el input y el label al contenedor
                        container.appendChild(radioInput);
                        container.appendChild(label);
                        container.appendChild(document.createElement('br'));
                    });

                    // Hacer visible el contenedor de ejercicios cuando se haga clic en el "+" (summary)
                    let details = container.closest('details');
                    details.addEventListener('toggle', function() {
                        if (details.open) {
                            container.style.display = 'block';
                        } else {
                            container.style.display = 'none';
                        }
                    });
                } else {
                    console.error("Los ejercicios no son un array válido.");
                }
            } else {
                console.error("Error en los ejercicios:", data.error || "Error desconocido");
            }
        } catch (error) {
            console.error('Error al procesar la respuesta JSON:', error);
            console.log('Respuesta del servidor (raw) para depuración:', text);  // Mostrar la respuesta cruda del servidor para depuración
        }
    })
    .catch(error => {
        console.error('Error en la solicitud:', error);
    });
}

// Asignar el evento a los inputs de músculo
document.querySelectorAll('input[name="musculo"]').forEach(input => {
    input.addEventListener('change', actualizarEjercicios);
});

</script>

<script>
    // Función para crear la previsualización del ejercicio
function mostrarPrevisualizacion(ejercicio) {
    // Buscar el contenedor de previsualización
    let container = document.getElementById('previsualizacion-ejercicio-container');

    // Limpiar el contenedor antes de agregar un nuevo ejercicio
    container.innerHTML = '';

    // Crear un div para la previsualización
    let previsualizacionDiv = document.createElement('div');
    previsualizacionDiv.classList.add('previsualizacion');

    // Agregar el nombre del ejercicio
    let nombreEjercicio = document.createElement('h3');
    nombreEjercicio.textContent = ejercicio;
    previsualizacionDiv.appendChild(nombreEjercicio);

    // Agregar la imagen de fondo
    let imagenEjercicio = document.createElement('div');
    imagenEjercicio.classList.add('imagen-fondo');
    imagenEjercicio.style.backgroundImage = `url('img/${ejercicio}.jpg')`;
    imagenEjercicio.style.backgroundSize = 'cover'; // Asegura que la imagen cubra todo el contenedor
    imagenEjercicio.style.height = '100px';  // Ajusta el tamaño de la imagen de fondo
    previsualizacionDiv.appendChild(imagenEjercicio);

    // Agregar el input para las repeticiones
    let inputRepeticiones = document.createElement('input');
    inputRepeticiones.type = 'text';
    inputRepeticiones.value = '8-10'; // Valor por defecto
    inputRepeticiones.classList.add('repeticiones');
    previsualizacionDiv.appendChild(inputRepeticiones);

    // Agregar la previsualización al contenedor
    container.appendChild(previsualizacionDiv);
}

// Función que se ejecuta cuando se selecciona un ejercicio
function asignarEventosEjercicios() {
    // Obtener todos los labels de los ejercicios
    let labels = document.querySelectorAll('.exercise-list label');

    labels.forEach(label => {
        // Asignar un evento de click a cada label
        label.addEventListener('click', function() {
            // Obtener el nombre del ejercicio desde el textContent del label
            let ejercicioSeleccionado = label.textContent.trim();
            mostrarPrevisualizacion(ejercicioSeleccionado);
        });
    });
}

// Llamar la función para asignar eventos después de cargar los ejercicios
asignarEventosEjercicios();

</script>

    
</body>
</html>